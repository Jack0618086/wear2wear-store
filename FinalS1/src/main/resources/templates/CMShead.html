<head>
<meta charset="UTF-8">
<meta name="viewport"
	content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>後台管理系统</title>
<link rel="stylesheet"
	href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.0/css/bootstrap.min.css">
	
<style>
body {
	background-color: #f8f9fa;
}
.sidebar {
	height: 100vh;
	background-color: #343a40;
}
.sidebar a {
	color: #ffffff;
}
.sidebar a:hover {
	background-color: #495057;
	color: #ffffff;
}
.content {
	padding: 20px;
}
#adminchatWindow {
    display: none; /* 一開始隱藏 */
    position: fixed;
    bottom: 0;
    right: 20px;
    width: 350px;
    height: 400px;
    border: 1px solid #ddd;
    background-color: white;
    z-index: 1000;
    box-shadow: 0px 0px 10px rgba(0, 0, 0, 0.1);
    overflow: hidden;  /* 避免內容溢出 */
}
        #adminChatButton {
    z-index: 2000; /* 增加z-index以确保按钮在其他元素之上 */
    transition: opacity 0.3s; /* 添加过渡效果 */
}

    .chat-header {
    background-color: #007bff;
    color: white;
    padding: 10px;
    cursor: move;
}

.chat-body {
    height: calc(100% - 110px);  /* 動態計算高度，避免溢出 */
    overflow-y: auto;
    padding: 10px;
}

.chat-footer {
    position: relative;
    padding: 10px;
    background-color: #f1f1f1;
    display: flex;
}

.chat-footer input {
    flex: 1;
    padding: 5px;
}

.chat-footer button {
    margin-left: 5px;
    padding: 5px 10px;
    background-color: #007bff;
    color: white;
    border: none;
}
.resize-handle {
            width: 10px;
            height: 10px;
            background-color: #ccc;
            position: absolute;
            bottom: 10px;
            right: 10px;
            cursor: se-resize;
        }

        /* 響應式設計 */
        @media (max-width: 576px) {
            #adminchatWindow {
                width: 100%;  /* 小屏幕时占满宽度 */
                height: 60%;  /* 高度设为60% */
                bottom: 0;
                right: 0;
            }
        }
        
    /* 按鈕閃爍動畫 */
    .btn-flashing {
        animation: flashing 1s infinite;
    }

    @keyframes flashing {
        0%, 100% {
            background-color: #ffcc00; /* 按鈕顏色 */
            color: #fff;
        }
        50% {
            background-color: #ff9900; /* 閃爍中顏色 */
            color: #fff;
        }
    }
</style>
</head>
<body>
	<div class="d-flex">
		<div class="sidebar p-3">
			<h4 class="text-white">管理選單</h4>
			<ul class="nav flex-column">
				<li class="nav-item"><a class="nav-link" th:href="@{/overview}">總覽</a></li>
				<li class="nav-item"><a class="nav-link" th:href="@{/users}">用戶管理</a></li>
				<li class="nav-item"><a class="nav-link" th:href="@{/products/add}">商品上架</a></li>
				<li class="nav-item"><a class="nav-link" th:href="@{/productlist}">商品管理</a></li>
				<li class="nav-item"><a class="nav-link" th:href="@{/orders}">訂單管理</a></li>
				<li class="nav-item"><a class="nav-link" th:href="@{/content}">內容管理</a></li>
				<li class="nav-item"><a class="nav-link"
					th:href="@{/payment-services}">支付與服務管理</a></li>
				<li class="nav-item"><a class="nav-link"
					th:href="@{/customer-support}">客服管理</a></li>
			</ul>
		</div>
		
		
		
		
		
		
		
		 <!-- 分頁測試 先勿動 -->
		 <!-- 分頁容器 -->
    <div id="tabs">
        <ul id="tabs-container">
            <!-- 動態生成的分頁標籤會插入這裡 -->
        </ul>
    </div>
    
     <!-- 分頁內容容器 -->
    <div id="tab-content">
        <!-- 分頁對應的內容將顯示在這裡 -->
    </div>
    
     <script th:inline="javascript">
        /* 這段 Javascript 將會處理 Thymeleaf 與動態分頁的結合 */
        document.querySelectorAll('#sidebar a').forEach(item => {
            item.addEventListener('click', function(event) {
                event.preventDefault();
                const pageName = this.getAttribute('data-page'); // 獲取點擊的頁面名稱

                // 檢查分頁是否已經存在
                const existingTab = document.querySelector(`#tabs-container li[data-page="${pageName}"]`);

                if (!existingTab) {
                    // 創建新分頁
                    const newTab = document.createElement('li');
                    newTab.setAttribute('data-page', pageName);
                    newTab.innerHTML = `<a href="#">${this.textContent} <span class="close-tab">x</span></a>`;
                    document.getElementById('tabs-container').appendChild(newTab);

                    // 添加關閉分頁功能
                    newTab.querySelector('.close-tab').addEventListener('click', function(event) {
                        event.stopPropagation(); // 阻止點擊冒泡
                        newTab.remove();
                        document.getElementById('tab-content').innerHTML = ''; // 清空內容區域
                    });

                    // 切換到該分頁並加載頁面內容
                    switchTab(pageName);
                } else {
                    switchTab(pageName); // 切換到已存在的分頁
                }
            });
        });

        function switchTab(pageName) {
            // 發送請求到 Thymeleaf 後端，動態加載內容
            fetch(`/loadPageContent?page=${pageName}`)
                .then(response => response.text())
                .then(html => {
                    document.getElementById('tab-content').innerHTML = html;
                })
                .catch(error => {
                    console.error('Error loading page content:', error);
                });
        }
    </script>
    
